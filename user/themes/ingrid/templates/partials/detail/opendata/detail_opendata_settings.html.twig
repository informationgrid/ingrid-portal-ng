{# @var hit \Grav\Plugin\SearchHitOpendata #}

{# theme_var #}
{% set isTimeInDescription = theme_var('hit_detail.time_in_description') %}
{% set sortAddressTyp = theme_var('hit_detail.address_order') %}
{% set sortContactByType = theme_var('hit_detail.contact_order') %}
{% set addressUnlink = theme_var('hit_detail.address_unlink') %}

{# var #}
{% set uuid = hit.id %}
{% set title = hit.title %}
{% set partners = partners %}

{# Vorschau #}
{% set previews = hit.previews %}

{# Beschreibung #}
{% set description = hit.description %}
{% set landing_page = hit.dcat.landing_page %}

{# Zeitbezug #}
{% set timeRefs = {} %}
{% set timeRefs = addKeyValue(timeRefs, "accrual_periodicity", hit.temporal.accrual_periodicity) %}
{% set timeRefs = addKeyValue(timeRefs, "created", hit.created) %}
{% set timeRefs = addKeyValue(timeRefs, "issued", hit.issued) %}

{# Raumbezug #}
{% set mapRefs = {} %}
{% set mapRefs = addKeyValue(mapRefs, "polygonGeojsons", hit.spatial.geometries) %}
{% set mapRefs = addKeyValue(mapRefs, "polygonWkts", hit.spatial.wkts) %}
{% set mapRefs = addKeyValue(mapRefs, "political_geocoding_level_uri", hit.political_geocoding_level_uri) %}

{# Verweise und Downloads #}
{% set linkRefs = {} %}
{% set linkRefs = addKeyValue(linkRefs, "links", hit.distributions) %}
{% if linkRefs.links %}
    {% set linkOtherRefs = linkRefs.links %}
{% endif %}

{# Fachinformationen #}
{% set infoRefs = {} %}
{% set infoRefs = addKeyValue(infoRefs, "quality_process_uri", hit.quality_process_uri) %}
{% set infoRefs = addKeyValue(infoRefs, "legal_basis", hit.legal_basis) %}

{% set infoRefs_additional = {} %}

{% set infoRefs_keyword = {} %}
{% set infoRefs_keyword = addKeyValue(infoRefs_keyword, "search_terms", hit.keywords|filterByKey("source", "FREE")) %}
{% set infoRefs_keyword = addKeyValue(infoRefs_keyword, "categories", hit.keywords|filterByKey("source", "THEMES")) %}

{# Kontakt #}
{% set contactRefs = hit.contacts %}

{# Metadaten Informationen #}
{% set metaInfoRefs = {} %}
{% set metaInfoRefs = addKeyValue(metaInfoRefs, "uuid", hit.id) %}
{% set metaInfoRefs = addKeyValue(metaInfoRefs, "modified", hit.metadata.modified) %}
{% set metaInfoRefs = addKeyValue(metaInfoRefs, "plug_data_source_name", hit.dataSourceName) %}
{% set metaInfoRefs = addKeyValue(metaInfoRefs, "plug_providers", hit.providers) %}
{% include 'partials/detail/opendata/detail_opendata_profile_settings.html.twig' %}