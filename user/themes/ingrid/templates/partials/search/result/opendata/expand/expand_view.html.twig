{% import 'macros/hit_macros.html.twig' as hit_macros %}

<a id="{{ hitOpenId }}" class="js-expander {% if isHitOpen %}is-hidden{% endif %}" title="{{ "SEARCH_RESULT.INFO_MORE"|t }}" href="#" {% if bboxes|length > 0 %}onclick="resizeMap({{ hitMapId }})"{% endif %}>
    <span class="icon  ic-ic-plus"></span>
    <span class="text">{{ "SEARCH_RESULT.INFO_MORE"|t }}</span>
</a>
<a class="js-expander-close {{ hitOpenId }} {% if not isHitOpen %}is-hidden{% endif %}" title="{{ "SEARCH_RESULT.INFO_LESS"|t }}" href="#">
    <span class="icon  ic-ic-minus"></span>
    <span class="text">{{ "SEARCH_RESULT.INFO_LESS"|t }}</span>
</a>
<div class="js-expander-content {{ hitOpenId }} {% if not isHitOpen %}is-hidden{% endif %}">
    <div class="row">
        <div class="xsmall-24 small-24 medium-14 large-14 xlarge-14 columns">

{# Ressourcen #}
            {% if distributions|length > 0 %}
                <div class="sub-section">
                    {{ hit_macros.render_fact_title("SEARCH_RESULT.OPENDATA.DISTRIBUTIONS.TITLE"|t, distributions|length) }}
                    <div class="document-list">
                        {% for distribution in distributions %}
                            {% set distributionUrl = distribution.access_url %}
                            {% set distributionTitle = distribution.title %}
                            {% if distributionTitle is empty %}
                                {% set distributionTitle = distributionUrl %}
                            {% endif %}
                            <div class="list-item">
                                <div>
                                    <a href="{{ distributionUrl }}" class="icon external-link" title="{{ distributionTitle }}" target="_blank" rel="noopener noreferrer">
                                        <span class="ic-ic-external"></span>
                                        <span class="text">
                                        {{ distributionTitle }}
                                        </span>
                                    </a>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
{# Kategorien #}
            {% if categories|length > 0 %}
                {{ hit_macros.render_fact_title("SEARCH_RESULT.OPENDATA.CATEGORIES.TITLE"|t) }}
                {% for category in categories %}
                    <div class="helper icon">
                        {% if category.key %}
                            <span class="ic-ic-{{ category.key|lower }}"></span>
                        {% endif %}
                        <span class="text">{{ category.term }}</span>
                    </div>
                {% endfor %}
            {% endif %}
{# RDF Darstellung #}
            <div class="teaser-links">
                {% include 'partials/search/result/opendata/expand/xml/expand_rdf_xml.html.twig' ignore missing %}
            </div>
        </div>
{# Vorschau / Karte #}
        {% set hasPreview = false %}
        {% set hasArea = spatial.geometries %}
        {% if hasPreview or hasArea %}
        <div class="columns">
            {% if hasPreview and hasArea %}
                <div class="swiper-container_{{ hitOpenId }} swiper-container swiper-container-background">
                    <div class="swiper-wrapper">
            {% else %}
                <div class="swiper-container-background">
            {% endif %}
{# Vorschau #}
            {% if hasPreview %}
                {% for link in previews %}
                    <div class="swiper-slide">
                        {{ hit_macros.render_fact_title("SEARCH_RESULT.INFO_PREVIEW"|t, null, 'text-center') }}
                        <a target="_blank" class="external-link" href="{{ link.url }}" title="{{ link.title }}" rel="noopener noreferrer">
                            <img {% if 'http:' in link.url %} src="./" data-src={% else %} src={% endif %}"{{ link.url }}" height="100" class="preview_image" alt="{{ link.title }}" title="{{ link.title }}" onerror="loadDefaultMapImage(this, '{{ url("theme://images/maps/image_map_" ~ partners[0] ~ ".png") }}', '{{ url("theme://images/maps/image_map.png") }}');">
                        </a>
                    </div>
                {% endfor %}
            {% endif %}
{# Karte #}
            {% if hasArea %}
                {% if hasPreview and hasArea %}
                    <div class="swiper-slide">
                {% endif %}
                {{ hit_macros.render_fact_title("SEARCH_RESULT.INFO_AREA"|t, null, 'text-center') }}
                {% include 'partials/global/map/map.html.twig' with { geojsons: spatial.geometries, displayControls: false, mapId: hitMapId, usePopUp: false } %}
                {% if hasPreview and hasArea %}
                    </div>
                {% endif %}
            {% endif %}

            {% if hasPreview and hasArea %}
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
                <script>
                    var swiper_{{ hitOpenId }} = new Swiper (".swiper-container_{{ hitOpenId }}", {
                        spaceBetween: 10,
                        grabCursor: true,
                        updateOnWindowResize: true,
                        observer: true,
                        observeParents: true,
                        pagination: {
                            el: '.swiper-pagination',
                            clickable: true
                        }
                    });
                </script>
            {% else %}
                </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</div>